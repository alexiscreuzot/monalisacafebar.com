{% assign current_lang_id = site.lang | strip %}
<div class="languages">
    <div class="selected-language" onclick="toggleLanguageMenu()">
        {{ site.translations[current_lang_id].global.current_lang_flag }}
    </div>
    <ul id="language-menu">
        {% assign languages = "es,en,fr" | split: ',' %}
        {% for lang_id in languages %}
            {% assign lang_flag = site.translations[lang_id].global.current_lang_flag %}
            {% assign lang_uri = site.translations[lang_id].global.lang_uri %}
            {% assign link = site.baseurl_root | append: lang_uri | append: page.url %}

            {% if lang_id != current_lang_id %}
                <li><a href="{{ link }}">{{ lang_flag }}</a></li>
            {% endif %}
        {% endfor %}
    </ul>
</div>

<script>
  function toggleLanguageMenu() {
      var menu = document.getElementById("language-menu");
      menu.classList.toggle("show");
  }
  
  window.onclick = function(event) {
        if (!event.target.matches('.selected-language')) {
            var menu = document.getElementById("language-menu");
            if (menu.classList.contains('show')) {
                menu.classList.remove('show');
            }
        }

    }
</script>
